<div class="space-y-8">
  <!-- HEADER CON BIENVENIDA -->
  <section class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg p-8 shadow-lg">
    <h1 class="text-4xl font-bold mb-2">Bienvenido a TalleresApp</h1>
    <p class="text-lg opacity-90">
      <% if user_signed_in? %>
        Hola, <%= current_user.email %>
        <% if current_user.admin? %>
          (Admin)
        <% end %>
      <% else %>
        Sistema de Gestión de Talleres Educativos
      <% end %>
    </p>
  </section>

  <!-- DASHBOARD DE ESTADÍSTICAS -->
  <section>
    <h2 class="text-2xl font-bold mb-6 text-gray-800">Estadísticas Generales</h2>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- Total Talleres -->
      <div class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow">
        <div class="flex items-start justify-between gap-4">
          <div class="flex-1">
            <p class="text-gray-500 text-sm font-medium">Total Talleres</p>
            <p class="text-3xl font-bold text-blue-600 mt-2"><%= @total_talleres %></p>
          </div>
          <svg class="w-8 h-8 text-blue-300 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"></path>
          </svg>
        </div>
      </div>

      <!-- Total Estudiantes -->
      <div class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow">
        <div class="flex items-start justify-between gap-4">
          <div class="flex-1">
            <p class="text-gray-500 text-sm font-medium">Total Estudiantes</p>
            <p class="text-3xl font-bold text-green-600 mt-2"><%= @total_estudiantes %></p>
          </div>
          <svg class="w-8 h-8 text-green-300 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path>
          </svg>
        </div>
      </div>

      <!-- Inscripciones Pendientes -->
      <div class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow border-l-4 border-yellow-500">
        <div class="flex items-start justify-between gap-4">
          <div class="flex-1">
            <p class="text-gray-500 text-sm font-medium">Inscripciones Pendientes</p>
            <p class="text-3xl font-bold text-yellow-600 mt-2"><%= @inscripciones_pendientes %></p>
          </div>
          <svg class="w-8 h-8 text-yellow-300 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"></path>
          </svg>
        </div>
      </div>

      <!-- Inscripciones Aprobadas -->
      <div class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow border-l-4 border-green-500">
        <div class="flex items-start justify-between gap-4">
          <div class="flex-1">
            <p class="text-gray-500 text-sm font-medium">Inscripciones Aprobadas</p>
            <p class="text-3xl font-bold text-green-600 mt-2"><%= @inscripciones_aprobadas %></p>
          </div>
          <svg class="w-8 h-8 text-green-300 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"></path>
          </svg>
        </div>
      </div>
    </div>
  </section>

  <!-- SECCIÓN ADMIN: NOTIFICACIONES Y ACTIVIDAD RECIENTE -->
  <% if user_signed_in? && current_user.admin? %>
    <section>
      <h2 class="text-2xl font-bold mb-6 text-gray-800">Panel Admin</h2>
      
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Notificaciones Recientes -->
        <div class="lg:col-span-2">
          <div class="bg-white rounded-lg shadow p-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-xl font-bold text-gray-800">Notificaciones</h3>
              <% if @notificaciones_sin_leer > 0 %>
                <span class="inline-block bg-red-500 text-white rounded-full px-3 py-1 text-sm font-medium">
                  <%= @notificaciones_sin_leer %> sin leer
                </span>
              <% end %>
            </div>

            <% if @notificaciones_recientes.any? %>
              <div class="space-y-3 max-h-96 overflow-y-auto">
                <% @notificaciones_recientes.each do |notif| %>
                  <div class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors <%= 'bg-blue-50' if notif.unread? %>">
                    <div class="flex-1">
                      <p class="font-medium text-gray-900"><%= notif.title %></p>
                      <p class="text-sm text-gray-600 mt-1"><%= notif.message %></p>
                      <p class="text-xs text-gray-400 mt-2"><%= time_ago_in_words(notif.created_at) %> atrás</p>
                    </div>
                    <% if notif.unread? %>
                      <span class="inline-block w-2 h-2 bg-blue-600 rounded-full ml-2 mt-1 flex-shrink-0"></span>
                    <% end %>
                  </div>
                <% end %>
              </div>
              <div class="mt-4 pt-4 border-t">
                <%= link_to "Ver todas las notificaciones", notifications_path, class: "text-blue-600 hover:text-blue-800 font-medium text-sm" %>
              </div>
            <% else %>
              <p class="text-gray-500 text-center py-8">No hay notificaciones</p>
            <% end %>
          </div>
        </div>

        <!-- Acciones Rápidas -->
        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="text-xl font-bold text-gray-800 mb-4">Acciones Rápidas</h3>
          <div class="space-y-3">
            <%= link_to "Nuevo Taller", new_taller_path, class: "block w-full bg-blue-600 text-white font-medium py-2 px-4 rounded hover:bg-blue-700 transition-colors text-center" %>
            <%= link_to "Nuevo Estudiante", new_estudiante_path, class: "block w-full bg-green-600 text-white font-medium py-2 px-4 rounded hover:bg-green-700 transition-colors text-center" %>
            <%= link_to "Ver Calificaciones", calificaciones_path, class: "block w-full bg-indigo-600 text-white font-medium py-2 px-4 rounded hover:bg-indigo-700 transition-colors text-center" %>
            <%= link_to "Gestionar Inscripciones", inscripciones_path, class: "block w-full bg-purple-600 text-white font-medium py-2 px-4 rounded hover:bg-purple-700 transition-colors text-center" %>
          </div>
        </div>
      </div>
    </section>

    <!-- ACTIVIDAD RECIENTE -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Talleres Recientes -->
      <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">Talleres Recientes</h3>
        <% if @talleres_recientes.any? %>
          <div class="space-y-2">
            <% @talleres_recientes.each do |taller| %>
              <div class="flex justify-between items-center p-3 hover:bg-gray-50 rounded transition-colors">
                <div>
                  <p class="font-medium text-gray-900"><%= taller.nombre %></p>
                  <p class="text-xs text-gray-500"><%= time_ago_in_words(taller.created_at) %> atrás</p>
                </div>
                <span class="inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium">
                  <%= taller.estudiantes.count %> estudiantes
                </span>
              </div>
            <% end %>
          </div>
        <% else %>
          <p class="text-gray-500 text-center py-6">No hay talleres recientes</p>
        <% end %>
      </div>

      <!-- Estudiantes Recientes -->
      <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">Estudiantes Recientes</h3>
        <% if @estudiantes_recientes.any? %>
          <div class="space-y-2">
            <% @estudiantes_recientes.each do |estudiante| %>
              <div class="flex justify-between items-center p-3 hover:bg-gray-50 rounded transition-colors">
                <div>
                  <p class="font-medium text-gray-900"><%= estudiante.nombre %></p>
                  <p class="text-xs text-gray-500"><%= estudiante.curso %></p>
                </div>
                <p class="text-xs text-gray-400"><%= time_ago_in_words(estudiante.created_at) %> atrás</p>
              </div>
            <% end %>
          </div>
        <% else %>
          <p class="text-gray-500 text-center py-6">No hay estudiantes recientes</p>
        <% end %>
      </div>
    </section>
  <% end %>

  <!-- INFORMACIÓN GENERAL PARA NO ADMINS -->
  <% unless user_signed_in? && current_user.admin? %>
    <section class="bg-white rounded-lg shadow p-8">
      <h2 class="text-2xl font-bold text-gray-800 mb-4">Bienvenido a TalleresApp</h2>
      <p class="text-gray-600 mb-4">
        Sistema integral para la gestión de talleres educativos. Aquí puedes:
      </p>
      <ul class="list-disc list-inside text-gray-600 space-y-2 mb-6">
        <li>Explorar todos los talleres disponibles</li>
        <li>Inscribirse en talleres de tu interés</li>
        <li>Visualizar tu progreso y calificaciones</li>
        <li>Mantenerte informado con notificaciones en tiempo real</li>
      </ul>
      
      <div class="pt-6 border-t">
        <% if !user_signed_in? %>
          <p class="text-gray-600 mb-4">Para acceder a todas las funciones:</p>
          <div class="flex gap-4">
            <%= link_to "Iniciar Sesión", new_user_session_path, class: "bg-blue-600 text-white font-medium py-2 px-6 rounded hover:bg-blue-700 transition-colors" %>
            <%= link_to "Crear Cuenta", new_user_registration_path, class: "border-2 border-blue-600 text-blue-600 font-medium py-2 px-6 rounded hover:bg-blue-50 transition-colors" %>
          </div>
        <% else %>
          <%= link_to "Ver Talleres", talleres_path, class: "inline-block bg-blue-600 text-white font-medium py-2 px-6 rounded hover:bg-blue-700 transition-colors" %>
        <% end %>
      </div>
    </section>
  <% end %>

	<div class="mt-8 bg-white rounded-lg shadow p-6">
		<h2 class="text-xl font-semibold mb-2">API</h2>
		<p class="text-sm text-gray-600 mb-4">Consumo básico para apps móviles o React.</p>
		<ul class="list-disc pl-5 text-sm text-gray-700">
			<li><%= link_to "/api/v1/talleres", api_v1_talleres_path, class: "text-indigo-600 hover:text-indigo-800" %></li>
			<li><%= link_to "/api/v1/estudiantes", api_v1_estudiantes_path, class: "text-indigo-600 hover:text-indigo-800" %></li>
		</ul>
	</div>
</div>
