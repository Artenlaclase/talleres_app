<%= form_with(model: @taller, class: "space-y-6") do |form| %>
  <% if @taller.errors.any? %>
    <div class="mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded">
      <h2 class="font-bold mb-2"><%= pluralize(@taller.errors.count, "error") %> impidió que se guardara:</h2>
      <ul class="list-disc pl-5">
        <% @taller.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <%= form.label :nombre, "Nombre del taller", class: "block font-semibold mb-1" %>
    <%= form.text_field :nombre,
        required: true,
        placeholder: "Ej. Robótica básica",
        class: "w-full border border-gray-300 rounded px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500" %>
    <% if @taller.errors[:nombre].present? %>
      <p class="text-sm text-red-600 mt-1"><%= @taller.errors[:nombre].first %></p>
    <% else %>
      <p class="text-xs text-gray-500 mt-1">Debe tener entre 3 y 50 caracteres.</p>
    <% end %>
  </div>

  <div>
    <%= form.label :descripcion, "Descripción", class: "block font-semibold mb-1" %>
    <%= form.text_area :descripcion,
        placeholder: "Breve detalle del contenido del taller",
        class: "w-full border border-gray-300 rounded px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500", rows: 4 %>
    <% if @taller.errors[:descripcion].present? %>
      <p class="text-sm text-red-600 mt-1"><%= @taller.errors[:descripcion].first %></p>
    <% else %>
      <p class="text-xs text-gray-500 mt-1">Máximo 500 caracteres.</p>
    <% end %>
  </div>

  <div>
    <%= form.label :fecha, "Fecha", class: "block font-semibold mb-1" %>
    <%= form.date_field :fecha,
        required: true,
        class: "w-full border border-gray-300 rounded px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500" %>
    <% if @taller.errors[:fecha].present? %>
      <p class="text-sm text-red-600 mt-1"><%= @taller.errors[:fecha].first %></p>
    <% end %>
  </div>

  <div data-controller="cupos" data-cupos-inscritos-value="<%= @taller.estudiantes.count %>">
    <%= form.label :cupos, "Cupos disponibles", class: "block font-semibold mb-1" %>
    <%= form.number_field :cupos,
        min: 1,
        step: 1,
        required: true,
        placeholder: "Ej. 20",
        data: { cupos_target: "input" },
        class: "w-full border border-gray-300 rounded px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500" %>
    <p data-cupos-target="warning" class="hidden text-sm mt-1"></p>
    <% if @taller.errors[:cupos].present? %>
      <p class="text-sm text-red-600 mt-1"><%= @taller.errors[:cupos].first %></p>
    <% else %>
      <p class="text-xs text-gray-500 mt-1">Ingrese un número entero mayor a 0.</p>
    <% end %>
  </div>

  <div>
    <%= form.label :numero_evaluaciones, "Número de evaluaciones permitidas", class: "block font-semibold mb-1" %>
    <%= form.number_field :numero_evaluaciones,
        min: 1,
        step: 1,
        value: @taller.numero_evaluaciones || 5,
        class: "w-full border border-gray-300 rounded px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500" %>
    <p class="text-xs text-gray-500 mt-1">Cantidad máxima de calificaciones por estudiante. Por defecto: 5</p>
  </div>

  <div class="flex items-center gap-2">
    <%= form.submit (@taller.new_record? ? "Crear Taller" : "Actualizar Taller"), class: "px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700" %>
    <%= link_to "Cancelar", talleres_path, class: "px-4 py-2 rounded border border-gray-300 text-gray-700 hover:bg-gray-50" %>
  </div>

<% end %>
